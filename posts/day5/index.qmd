---
title: "Day 5 of MedBioInfo"
date: 2025-10-10
categories: [medbioinfo, learning, data-science, AI, visualization]
author: "August Lundholm"
description: "Day 5 - AI in Bioinformatics and Data Visualization with ggplot"
draft: false
---

# Day 5 of MedBioInfo

Day 5  we had an important discussion about AI in bioinformatics (actually the discussion were onday 4 because of us maxing out our allocated processing power on hp2nc and things were moved around) and a lecture + excerzises in data visualization with ggplot! 

## Today's Focus

Today we covered two topics:
- **Critical evaluation of AI in bioinformatics** - We talked about the benefits, risks, and responsible usage
- **Data visualization with ggplot** - Learning plottign in R

## Morning Session - AI in Bioinformatics
<!-- Replace "image.png" with the actual filename in the same folder -->
![](genai_marketshare.png){fig-alt="Marketshare of the different generative AI chatbots." width="80%"}
### The AI Revolution

In just 3 years, Large Language Models (LLMs) have become mainstream. ChatGPT gained **100 million users in 2 months** after its 2022 release, making it the fastest-growing consumer application in history.

### Machine Learning in Bioinformatics - Historical Context

ML has been used in bioinformatics for decades:
- **Supervised learning** - Classification and regression on annotated data
- **Unsupervised learning** - Pattern discovery without human input
- **Applications** - Clustering, association, dimensionality reduction

GenAI represents the next evolutionary step in applying machine learning into our lives.

## Critical Issues with AI

### 1. Training Data Bias

AI models inherit biases from their training data:
- **Historical bias** - "History written by the winners"
- **Internet bias** - Unequal access and participation
- **Quality issues** - Not everyone contributes equally online

> AI is not trained to be wrong and will "happily hallucinate an answer" rather than admit uncertainty

### 2. Impact on Learning and Productivity

**Learning concerns:**
- 2025 study showed adults using ChatGPT for essays were consistently outperformed by those writing without AI
- Significantly lower brain engagement when using AI assistance

**Productivity paradox:**
- Study of experienced developers (5+ years) found AI tools actually reduced productivity
- Time spent on prompting, reviewing AI responses, and being idle
- Less time actually coding and problem-solving

![METR study results showing AI impact on developer productivity](metr_ai.png){fig-alt="METR study results showing the impact of AI tools on experienced developer productivity." width="70%"}

### 3. Data Privacy and Legal Issues

**Critical concerns for bioinformatics:**
- Biological data is highly sensitive and often legally protected
- Terms of Service violations
- Copyright issues
- GDPR compliance

**Best practices:**
- Check Terms of Service explicitly and frequently
- Use GDPR-compliant tools when possible
- Share data descriptions, not actual datasets
- Be wary of browser extensions that steal personal data

### 4. Environmental Impact

**Resource consumption:**
- Data centers use more electricity than many countries
- Massive water requirements for cooling
- Built near poor communities, often draining local resources

### 5. Changing How We Communicate

AI is already changing language patterns:
- Words like "delve" and "meticulous" increasingly common in academic talks.
- Different AI models have distinct writing styles.
- 24% of internet content was AI-generated by end of 2023 from 2-3% in 2022.

![ChatGPT's impact on academic language use](chatgpt_delve.png){fig-alt="Chart showing the increasing use of words like 'delve' in academic presentations, correlating with ChatGPT adoption." width="70%"}

## Responsible AI Usage Guidelines

### Questions to Ask Before Using AI:

1. Am I phrasing my prompt effectively?
2. Can I find this information another way?
3. How much time am I actually saving?
4. Do I know enough to identify AI errors?
5. What are the consequences of testing AI solutions?

## Afternoon Session - Data Visualization with ggplot

### Introduction to ggplot

After completing downstream analyses, visualization becomes crucial for:
- **Results presentation** - Making findings accessible
- **Pattern recognition** - Discovering insights in data
- **Communication** - Sharing discoveries with others

[ggplot2](https://ggplot2.tidyverse.org/) is R's powerful visualization package, part of the tidyverse ecosystem.

### ggplot Capabilities

The package offers incredible versatility for creating:
- **Statistical plots** - Scatter plots, histograms, box plots
- **Multi-dimensional visualizations** - Faceting and grouping
- **Custom themes** - Professional publication-ready graphics
- **Interactive elements** - Enhanced user engagement

### Hands-on Practice

We worked through practical examples using the [NBIS tutorial by Roy Francis](https://nbisweden.github.io/raukr-2023/labs/ggplot/), covering:

```r
# Basic ggplot structure
library(ggplot2)

# Example scatter plot using iris dataset
ggplot(data = iris, aes(x = Petal.Length, y = Petal.Width)) +
  geom_point() +
  theme_minimal() +
  labs(title = "My Analysis Results",
       x = "Petal Length",
       y = "Petal Width")
```

![Basic scatter plot example](basic_scatter_plot.png){fig-alt="Basic scatter plot showing the relationship between petal length and width using the iris dataset with minimal theme styling." width="70%"}

```r
# Advanced plotting with facets using iris dataset
ggplot(data = iris, aes(x = Petal.Length, y = Petal.Width, color = Species)) +
  geom_point() +
  facet_wrap(~Species) +
  theme_bw()
```

![Faceted scatter plot with color grouping](faceted_scatter_plot.png){fig-alt="Advanced scatter plot with color grouping by species and faceting, demonstrating ggplot's layered approach using the iris dataset." width="80%"}

### Advanced Tutorial Examples

We also worked through two complex examples from the NBIS tutorial that demonstrate professional-level data visualization techniques:

#### 1. Economist-Style Corruption vs Development Scatter Plot

This recreation of [The Economist's corruption analysis](https://www.economist.com/blogs/dailychart/2011/12/corruption-and-development) demonstrates advanced ggplot2 techniques:

```r
# Read and process the data
ec <- read.csv("data_economist.csv", header = TRUE)

# Refactor regions with line breaks for legend
ec$Region <- factor(ec$Region,
                    levels = c("EU W. Europe", "Americas", "Asia Pacific",
                              "East EU Cemt Asia", "MENA", "SSA"),
                    labels = c("OECD", "Americas", "Asia &\nOceania",
                              "Central &\nEastern Europe",
                              "Middle East &\nNorth Africa",
                              "Sub-Saharan\nAfrica"))

# Create sophisticated scatter plot with trend line
ggplot(ec, aes(x = CPI, y = HDI, color = Region)) +
  geom_smooth(aes(fill = "red"), method = "lm", formula = y ~ poly(x, 2), 
              se = FALSE, color = "red", linewidth = 0.6) +
  geom_point(shape = 21, size = 3, stroke = 0.8, fill = "white") +
  geom_text(data = subset(ec, Country %in% labels), aes(label = Country),
            color = "black", size = 2.5) +
  scale_color_manual(values = c("#23576E", "#099FDB", "#29B00E", 
                               "#208F84", "#F55840", "#924F3E")) +
  labs(title = "Corruption and human development") +
  theme_minimal()
```

![Corruption and Human Development Analysis](tutorial_corruption_plot.png){fig-alt="Professional recreation of The Economist's corruption vs human development scatter plot showing the relationship between corruption perceptions and quality of life across countries." width="90%"}

#### 2. Wall Street Journal-Style Measles Heatmap

This recreation of [WSJ's measles vaccination impact visualization](http://graphics.wsj.com/infectious-diseases-and-vaccines/) shows complex data transformation and heatmap creation:

```r
# Read and transform the complex dataset
me <- read.csv("data_wsj.csv", header = TRUE, stringsAsFactors = FALSE, skip = 2)

# Custom function for handling missing data
fun1 <- function(x) ifelse(all(is.na(x)), NA, sum(x, na.rm = TRUE))

# Complex data transformation pipeline
me3 <- me %>%
  gather(key = state, value = value, -YEAR, -WEEK) %>%
  mutate(value = str_replace(value, "^-$", NA_character_),
         value = as.numeric(value)) %>%
  group_by(YEAR, state) %>% 
  summarise(total = fun1(value), .groups = "drop") %>%
  mutate(state = str_replace_all(state, "[.]", " "),
         state = str_to_title(state))

# Create sophisticated heatmap with custom color scale
ggplot(me3, aes(x = year, y = reorder(state, desc(state)), fill = total)) +
  geom_tile(color = "white", linewidth = 0.25) +
  scale_fill_gradientn(colors = cols, na.value = "grey95",
                       limits = c(0, 4000),
                       values = c(0, 0.01, 0.02, 0.03, 0.09, 0.1, 0.15, 0.25, 0.4, 0.5, 1)) +
  geom_segment(x = 1963, xend = 1963, y = 0, yend = 51.5, linewidth = 0.6) +
  annotate("text", label = "Vaccine introduced", x = 1963, y = 53) +
  coord_fixed() +
  theme_minimal()
```

![Measles Cases Heatmap](tutorial_measles_heatmap.png){fig-alt="Professional recreation of the Wall Street Journal's measles cases heatmap showing the dramatic impact of vaccine introduction in 1963 across US states." width="90%"}

These advanced examples demonstrate:
- **Complex data transformation** using tidyverse functions
- **Custom color palettes** and sophisticated scaling
- **Annotation techniques** for highlighting key events
- **Professional styling** matching publication standards
- **Multi-layered plotting** with geom combinations

### Key ggplot Concepts

- **Grammar of Graphics** - Systematic approach to building plots
- **Layered approach** - Adding elements incrementally
- **Aesthetic mappings** - Connecting data to visual properties
- **Geometric objects** - Points, lines, bars, etc.
- **Themes and styling** - Professional appearance


## Resources and References
- [NBIS ggplot Tutorial](https://nbisweden.github.io/raukr-2023/labs/ggplot/)


---

*Day 5 complete and the course done! Thank you amrei for a really good and interesting course! 